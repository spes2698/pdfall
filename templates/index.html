<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF工具集</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .tool-card .tool-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
            display: block;
        }
        .tools-grid {
            gap: 40px 30px;
        }
        @media (max-width: 768px) {
            .tools-grid {
                gap: 20px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>PDF工具集</h1>
            <div class="donate-section" style="display:flex;flex-direction:column;align-items:center;justify-content:center;margin:32px 0 0 0;">
                <div style="font-weight:bold;font-size:20px;margin-bottom:12px;">扫码投喂支持本网站</div>
                <img id="alipay-qr" src="" alt="支付宝收款二维码" style="max-width:240px;width:80vw;border-radius:12px;box-shadow:0 2px 12px rgba(0,0,0,0.08);margin-bottom:14px;" />
                <div id="alipay-qr-tip" style="color:#e74c3c;font-size:14px;display:none;margin-bottom:8px;">二维码加载失败，请刷新页面或稍后重试</div>
                <div style="max-width:420px;text-align:center;font-size:16px;line-height:2;margin-top:2px;word-break:break-all;">
                    <span style="font-weight:bold;color:#e67e22;font-size:17px;background:rgba(255,236,179,0.85);padding:6px 14px;border-radius:10px;box-shadow:0 1px 6px rgba(230,126,34,0.08);display:inline-block;letter-spacing:1px;">本网站是公益网站，运营成本均来自用户捐款扫码，超出所需运营成本的用户捐款将全部被用于乡村儿童教育事业。</span>
                </div>
            </div>
            <div class="tip-info" style="margin:18px 0 0 0;text-align:center;font-size:18px;font-weight:bold;color:#3498db;">⏳ 请耐心等待下载窗口弹出，预计需要等待30-60秒，祝您天天开心 😊</div>
            <p>一站式PDF处理平台，支持PDF转换、合并、拆分、加密、压缩和JPG压缩等多种功能</p>
        </header>

        <main>
            {% with messages = get_flashed_messages() %}
                {% if messages %}
                    <div class="flash-messages">
                        {% for message in messages %}
                            <div class="alert">{{ message }}</div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}

            <div class="tools-grid">
                <div class="tool-card">
                    <span class="tool-icon">📝</span>
                    <h2>PDF转Word</h2>
                    <p>将PDF文件高质量转换为可编辑Word文档，保留原始排版和图片。</p>
                    <a href="/upload" class="btn-tool">转换</a>
                </div>

                <div class="tool-card">
                    <span class="tool-icon">📎</span>
                    <h2>PDF合并</h2>
                    <p>将多个PDF文件合并为一个，顺序自定义，便于整理资料。</p>
                    <a href="{{ url_for('merge_page') }}" class="btn-tool">合并</a>
                </div>
                
                <div class="tool-card">
                    <span class="tool-icon">✂️</span>
                    <h2>PDF拆分</h2>
                    <p>将PDF拆分为单页或提取指定页面，支持范围选择。</p>
                    <a href="{{ url_for('split_page') }}" class="btn-tool">拆分</a>
                </div>
                
                <div class="tool-card">
                    <span class="tool-icon">🔒</span>
                    <h2>PDF加密解密</h2>
                    <p>为PDF添加密码保护或移除密码，保障文档安全。</p>
                    <a href="{{ url_for('security_page') }}" class="btn-tool">安全工具</a>
                </div>
                
                <div class="tool-card">
                    <span class="tool-icon">📉</span>
                    <h2>PDF压缩</h2>
                    <p>减小PDF文件体积，便于分享和存储，支持多种压缩等级。</p>
                    <a href="{{ url_for('compress_page') }}" class="btn-tool">压缩</a>
                </div>
                
                <div class="tool-card">
                    <span class="tool-icon">🖼️</span>
                    <h2>PDF转图片</h2>
                    <p>将PDF页面批量导出为高清图片，支持JPG/PNG格式。</p>
                    <a href="{{ url_for('pdf_to_image_page') }}" class="btn-tool">PDF转图片</a>
                </div>
                
                <div class="tool-card">
                    <span class="tool-icon">🗂️</span>
                    <h2>图片转PDF</h2>
                    <p>将多张图片合并为一个PDF，支持JPG/PNG/TIFF等格式。</p>
                    <a href="{{ url_for('image_to_pdf_page') }}" class="btn-tool">图片转PDF</a>
                </div>

                <div class="tool-card">
                    <span class="tool-icon">🗜️</span>
                    <h2>JPG压缩</h2>
                    <p>压缩JPG图片，减小体积，便于分享和存储。</p>
                    <a href="/jpg_compress" class="btn-tool">JPG压缩</a>
                </div>
            </div>

            <div class="features">
                <h2>功能特点</h2>
                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon">🚀</div>
                        <h3>极速处理</h3>
                        <p>几秒钟内完成文件转换、合并、拆分等操作</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">🔒</div>
                        <h3>安全可靠</h3>
                        <p>所有文件处理后自动删除，保护您的隐私</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">📱</div>
                        <h3>多端适配</h3>
                        <p>支持电脑、手机、平板等多种设备访问</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">💯</div>
                        <h3>高质量输出</h3>
                        <p>最大程度保留原始文档的布局和清晰度</p>
                    </div>
                </div>
            </div>

            </div>
        </main>
        <footer>
            <p>&copy; 2023 PDF工具集 | 技术支持</p>
        </footer>
    </div>
    
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    <script src="{{ url_for('static', filename='js/convert.js') }}"></script>
    <script>
        function selectFunction(functionType) {
            document.getElementById('functionType').value = functionType;
            const buttons = document.querySelectorAll('.function-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // 更新文件类型提示
            const fileTypeHint = document.getElementById('fileTypeHint');
            switch(functionType) {
                case 'pdf2word':
                    fileTypeHint.textContent = '支持的文件类型：PDF';
                    break;
                case 'pdf2excel':
                    fileTypeHint.textContent = '支持的文件类型：PDF';
                    break;
                case 'pdf2ppt':
                    fileTypeHint.textContent = '支持的文件类型：PDF';
                    break;
                case 'pdf2image':
                    fileTypeHint.textContent = '支持的文件类型：PDF';
                    break;
                case 'word2pdf':
                    fileTypeHint.textContent = '支持的文件类型：DOC, DOCX';
                    break;
                case 'excel2pdf':
                    fileTypeHint.textContent = '支持的文件类型：XLS, XLSX';
                    break;
                case 'ppt2pdf':
                    fileTypeHint.textContent = '支持的文件类型：PPT, PPTX';
                    break;
                case 'compress_jpg':
                    fileTypeHint.textContent = '支持的文件类型：JPG, JPEG';
                    break;
            }
        }

        window.addEventListener('DOMContentLoaded', function() {
            fetch('/api/generate_alipay_qr', {method: 'POST'})
              .then(res => res.json())
              .then(data => {
                if(data.success) {
                  document.getElementById('alipay-qr').src = 'data:image/png;base64,' + data.img_base64;
                  document.getElementById('alipay-qr-tip').style.display = 'none';
                } else {
                  document.getElementById('alipay-qr-tip').style.display = '';
                }
              })
              .catch(() => {
                document.getElementById('alipay-qr-tip').style.display = '';
              });
        });
    </script>
</body>
</html> 